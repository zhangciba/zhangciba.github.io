<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="DIYER糍粑,DIYER糍粑的博客,糍粑学习的地方,CIBA" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="DIYER糍粑,CIBA,糍粑学习的地方">
<meta property="og:type" content="website">
<meta property="og:title" content="DIYER糍粑的博客">
<meta property="og:url" content="http://blog.zhangchi.xyz/index.html">
<meta property="og:site_name" content="DIYER糍粑的博客">
<meta property="og:description" content="DIYER糍粑,CIBA,糍粑学习的地方">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DIYER糍粑的博客">
<meta name="twitter:description" content="DIYER糍粑,CIBA,糍粑学习的地方">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: 'NCCTAVOMGS',
      apiKey: '90a1b37d9db46c7ad69df6b94bd751b9',
      indexName: 'blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"请输入搜索关键字","hits_empty":"没有找到与 [ ${query} ] 有关的内容","hits_stats":"${hits} 条记录，共耗时 ${time} 毫秒"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.zhangchi.xyz/"/>





  <title> DIYER糍粑,DIYER糍粑的博客,糍粑学习的地方,CIBA - DIYER糍粑的博客 - DIYER糍粑,CIBA,糍粑学习的地方 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-77014447-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b77ecb103df050a82108d6cf4aa776f2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=zhangchixtacbn&web_id=zhangchixtacbn" language="JavaScript"></script>
  </div>






  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DIYER糍粑的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">快乐学习、快乐工作、快乐生活</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/红黑树源码.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/红黑树源码.html" itemprop="url">红黑树源码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-28T20:57:01+08:00">
                2018-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/红黑树源码.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/红黑树源码.html" class="cy_cmt_count" data-xid="红黑树源码.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/红黑树源码.html" class="leancloud_visitors" data-flag-title="红黑树源码">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  2,200
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  14分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">  Red Black Trees</span><br><span class="line">  (C) 1999  Andrea Arcangeli &lt;andrea@suse.de&gt;</span><br><span class="line">  (C) 2002  David Woodhouse &lt;dwmw2@infradead.org&gt;</span><br><span class="line">  (C) 2012  Michel Lespinasse &lt;walken@google.com&gt;</span><br><span class="line"></span><br><span class="line">  This program is free software; you can redistribute it and/or modify</span><br><span class="line">  it under the terms of the GNU General Public License as published by</span><br><span class="line">  the Free Software Foundation; either version 2 of the License, or</span><br><span class="line">  (at your option) any later version.</span><br><span class="line"></span><br><span class="line">  This program is distributed in the hope that it will be useful,</span><br><span class="line">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">  GNU General Public License for more details.</span><br><span class="line"></span><br><span class="line">  You should have received a copy of the GNU General Public License</span><br><span class="line">  along with this program; if not, write to the Free Software</span><br><span class="line">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span><br><span class="line"></span><br><span class="line">  linux/lib/rbtree.c</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#include &lt;linux/rbtree_augmented.h&gt;</span><br><span class="line">#include &lt;linux/export.h&gt;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * red-black trees properties:  http://en.wikipedia.org/wiki/Rbtree</span><br><span class="line"> *</span><br><span class="line"> *  1) A node is either red or black</span><br><span class="line"> *  2) The root is black</span><br><span class="line"> *  3) All leaves (NULL) are black</span><br><span class="line"> *  4) Both children of every red node are black</span><br><span class="line"> *  5) Every simple path from root to leaves contains the same number</span><br><span class="line"> *     of black nodes.</span><br><span class="line"> *</span><br><span class="line"> *  4 and 5 give the O(log n) guarantee, since 4 implies you cannot have two</span><br><span class="line"> *  consecutive red nodes in a path and every red node is therefore followed by</span><br><span class="line"> *  a black. So if B is the number of black nodes on every simple path (as per</span><br><span class="line"> *  5), then the longest possible path due to 4 is 2B.</span><br><span class="line"> *</span><br><span class="line"> *  We shall indicate color with case, where black nodes are uppercase and red</span><br><span class="line"> *  nodes will be lowercase. Unknown color nodes shall be drawn as red within</span><br><span class="line"> *  parentheses and have some accompanying text comment.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">static inline void rb_set_black(struct rb_node *rb)</span><br><span class="line">&#123;</span><br><span class="line">	rb-&gt;__rb_parent_color |= RB_BLACK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static inline struct rb_node *rb_red_parent(struct rb_node *red)</span><br><span class="line">&#123;</span><br><span class="line">	return (struct rb_node *)red-&gt;__rb_parent_color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Helper function for rotations:</span><br><span class="line"> * - old&apos;s parent and color get assigned to new</span><br><span class="line"> * - old gets assigned new as a parent and &apos;color&apos; as a color.</span><br><span class="line"> */</span><br><span class="line">static inline void</span><br><span class="line">__rb_rotate_set_parents(struct rb_node *old, struct rb_node *new,</span><br><span class="line">			struct rb_root *root, int color)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *parent = rb_parent(old);</span><br><span class="line">	new-&gt;__rb_parent_color = old-&gt;__rb_parent_color;</span><br><span class="line">	rb_set_parent_color(old, new, color);</span><br><span class="line">	__rb_change_child(old, new, parent, root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static __always_inline void</span><br><span class="line">__rb_insert(struct rb_node *node, struct rb_root *root,</span><br><span class="line">	    void (*augment_rotate)(struct rb_node *old, struct rb_node *new))</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *parent = rb_red_parent(node), *gparent, *tmp;</span><br><span class="line"></span><br><span class="line">	while (true) &#123;</span><br><span class="line">		/*</span><br><span class="line">		 * Loop invariant: node is red</span><br><span class="line">		 *</span><br><span class="line">		 * If there is a black parent, we are done.</span><br><span class="line">		 * Otherwise, take some corrective action as we don&apos;t</span><br><span class="line">		 * want a red root or two consecutive red nodes.</span><br><span class="line">		 */</span><br><span class="line">		if (!parent) &#123;</span><br><span class="line">			rb_set_parent_color(node, NULL, RB_BLACK);</span><br><span class="line">			break;</span><br><span class="line">		&#125; else if (rb_is_black(parent))</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		gparent = rb_red_parent(parent);</span><br><span class="line"></span><br><span class="line">		tmp = gparent-&gt;rb_right;</span><br><span class="line">		if (parent != tmp) &#123;	/* parent == gparent-&gt;rb_left */</span><br><span class="line">			if (tmp &amp;&amp; rb_is_red(tmp)) &#123;</span><br><span class="line">				/*</span><br><span class="line">				 * Case 1 - color flips</span><br><span class="line">				 *</span><br><span class="line">				 *       G            g</span><br><span class="line">				 *      / \          / \</span><br><span class="line">				 *     p   u  --&gt;   P   U</span><br><span class="line">				 *    /            /</span><br><span class="line">				 *   n            N</span><br><span class="line">				 *</span><br><span class="line">				 * However, since g&apos;s parent might be red, and</span><br><span class="line">				 * 4) does not allow this, we need to recurse</span><br><span class="line">				 * at g.</span><br><span class="line">				 */</span><br><span class="line">				rb_set_parent_color(tmp, gparent, RB_BLACK);</span><br><span class="line">				rb_set_parent_color(parent, gparent, RB_BLACK);</span><br><span class="line">				node = gparent;</span><br><span class="line">				parent = rb_parent(node);</span><br><span class="line">				rb_set_parent_color(node, parent, RB_RED);</span><br><span class="line">				continue;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			tmp = parent-&gt;rb_right;</span><br><span class="line">			if (node == tmp) &#123;</span><br><span class="line">				/*</span><br><span class="line">				 * Case 2 - left rotate at parent</span><br><span class="line">				 *</span><br><span class="line">				 *      G             G</span><br><span class="line">				 *     / \           / \</span><br><span class="line">				 *    p   U  --&gt;    n   U</span><br><span class="line">				 *     \           /</span><br><span class="line">				 *      n         p</span><br><span class="line">				 *</span><br><span class="line">				 * This still leaves us in violation of 4), the</span><br><span class="line">				 * continuation into Case 3 will fix that.</span><br><span class="line">				 */</span><br><span class="line">				parent-&gt;rb_right = tmp = node-&gt;rb_left;</span><br><span class="line">				node-&gt;rb_left = parent;</span><br><span class="line">				if (tmp)</span><br><span class="line">					rb_set_parent_color(tmp, parent,</span><br><span class="line">							    RB_BLACK);</span><br><span class="line">				rb_set_parent_color(parent, node, RB_RED);</span><br><span class="line">				augment_rotate(parent, node);</span><br><span class="line">				parent = node;</span><br><span class="line">				tmp = node-&gt;rb_right;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			/*</span><br><span class="line">			 * Case 3 - right rotate at gparent</span><br><span class="line">			 *</span><br><span class="line">			 *        G           P</span><br><span class="line">			 *       / \         / \</span><br><span class="line">			 *      p   U  --&gt;  n   g</span><br><span class="line">			 *     /                 \</span><br><span class="line">			 *    n                   U</span><br><span class="line">			 */</span><br><span class="line">			gparent-&gt;rb_left = tmp;  /* == parent-&gt;rb_right */</span><br><span class="line">			parent-&gt;rb_right = gparent;</span><br><span class="line">			if (tmp)</span><br><span class="line">				rb_set_parent_color(tmp, gparent, RB_BLACK);</span><br><span class="line">			__rb_rotate_set_parents(gparent, parent, root, RB_RED);</span><br><span class="line">			augment_rotate(gparent, parent);</span><br><span class="line">			break;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			tmp = gparent-&gt;rb_left;</span><br><span class="line">			if (tmp &amp;&amp; rb_is_red(tmp)) &#123;</span><br><span class="line">				/* Case 1 - color flips */</span><br><span class="line">				rb_set_parent_color(tmp, gparent, RB_BLACK);</span><br><span class="line">				rb_set_parent_color(parent, gparent, RB_BLACK);</span><br><span class="line">				node = gparent;</span><br><span class="line">				parent = rb_parent(node);</span><br><span class="line">				rb_set_parent_color(node, parent, RB_RED);</span><br><span class="line">				continue;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			tmp = parent-&gt;rb_left;</span><br><span class="line">			if (node == tmp) &#123;</span><br><span class="line">				/* Case 2 - right rotate at parent */</span><br><span class="line">				parent-&gt;rb_left = tmp = node-&gt;rb_right;</span><br><span class="line">				node-&gt;rb_right = parent;</span><br><span class="line">				if (tmp)</span><br><span class="line">					rb_set_parent_color(tmp, parent,</span><br><span class="line">							    RB_BLACK);</span><br><span class="line">				rb_set_parent_color(parent, node, RB_RED);</span><br><span class="line">				augment_rotate(parent, node);</span><br><span class="line">				parent = node;</span><br><span class="line">				tmp = node-&gt;rb_left;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			/* Case 3 - left rotate at gparent */</span><br><span class="line">			gparent-&gt;rb_right = tmp;  /* == parent-&gt;rb_left */</span><br><span class="line">			parent-&gt;rb_left = gparent;</span><br><span class="line">			if (tmp)</span><br><span class="line">				rb_set_parent_color(tmp, gparent, RB_BLACK);</span><br><span class="line">			__rb_rotate_set_parents(gparent, parent, root, RB_RED);</span><br><span class="line">			augment_rotate(gparent, parent);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Inline version for rb_erase() use - we want to be able to inline</span><br><span class="line"> * and eliminate the dummy_rotate callback there</span><br><span class="line"> */</span><br><span class="line">static __always_inline void</span><br><span class="line">____rb_erase_color(struct rb_node *parent, struct rb_root *root,</span><br><span class="line">	void (*augment_rotate)(struct rb_node *old, struct rb_node *new))</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *node = NULL, *sibling, *tmp1, *tmp2;</span><br><span class="line"></span><br><span class="line">	while (true) &#123;</span><br><span class="line">		/*</span><br><span class="line">		 * Loop invariants:</span><br><span class="line">		 * - node is black (or NULL on first iteration)</span><br><span class="line">		 * - node is not the root (parent is not NULL)</span><br><span class="line">		 * - All leaf paths going through parent and node have a</span><br><span class="line">		 *   black node count that is 1 lower than other leaf paths.</span><br><span class="line">		 */</span><br><span class="line">		sibling = parent-&gt;rb_right;</span><br><span class="line">		if (node != sibling) &#123;	/* node == parent-&gt;rb_left */</span><br><span class="line">			if (rb_is_red(sibling)) &#123;</span><br><span class="line">				/*</span><br><span class="line">				 * Case 1 - left rotate at parent</span><br><span class="line">				 *</span><br><span class="line">				 *     P               S</span><br><span class="line">				 *    / \             / \</span><br><span class="line">				 *   N   s    --&gt;    p   Sr</span><br><span class="line">				 *      / \         / \</span><br><span class="line">				 *     Sl  Sr      N   Sl</span><br><span class="line">				 */</span><br><span class="line">				parent-&gt;rb_right = tmp1 = sibling-&gt;rb_left;</span><br><span class="line">				sibling-&gt;rb_left = parent;</span><br><span class="line">				rb_set_parent_color(tmp1, parent, RB_BLACK);</span><br><span class="line">				__rb_rotate_set_parents(parent, sibling, root,</span><br><span class="line">							RB_RED);</span><br><span class="line">				augment_rotate(parent, sibling);</span><br><span class="line">				sibling = tmp1;</span><br><span class="line">			&#125;</span><br><span class="line">			tmp1 = sibling-&gt;rb_right;</span><br><span class="line">			if (!tmp1 || rb_is_black(tmp1)) &#123;</span><br><span class="line">				tmp2 = sibling-&gt;rb_left;</span><br><span class="line">				if (!tmp2 || rb_is_black(tmp2)) &#123;</span><br><span class="line">					/*</span><br><span class="line">					 * Case 2 - sibling color flip</span><br><span class="line">					 * (p could be either color here)</span><br><span class="line">					 *</span><br><span class="line">					 *    (p)           (p)</span><br><span class="line">					 *    / \           / \</span><br><span class="line">					 *   N   S    --&gt;  N   s</span><br><span class="line">					 *      / \           / \</span><br><span class="line">					 *     Sl  Sr        Sl  Sr</span><br><span class="line">					 *</span><br><span class="line">					 * This leaves us violating 5) which</span><br><span class="line">					 * can be fixed by flipping p to black</span><br><span class="line">					 * if it was red, or by recursing at p.</span><br><span class="line">					 * p is red when coming from Case 1.</span><br><span class="line">					 */</span><br><span class="line">					rb_set_parent_color(sibling, parent,</span><br><span class="line">							    RB_RED);</span><br><span class="line">					if (rb_is_red(parent))</span><br><span class="line">						rb_set_black(parent);</span><br><span class="line">					else &#123;</span><br><span class="line">						node = parent;</span><br><span class="line">						parent = rb_parent(node);</span><br><span class="line">						if (parent)</span><br><span class="line">							continue;</span><br><span class="line">					&#125;</span><br><span class="line">					break;</span><br><span class="line">				&#125;</span><br><span class="line">				/*</span><br><span class="line">				 * Case 3 - right rotate at sibling</span><br><span class="line">				 * (p could be either color here)</span><br><span class="line">				 *</span><br><span class="line">				 *   (p)           (p)</span><br><span class="line">				 *   / \           / \</span><br><span class="line">				 *  N   S    --&gt;  N   Sl</span><br><span class="line">				 *     / \             \</span><br><span class="line">				 *    sl  Sr            s</span><br><span class="line">				 *                       \</span><br><span class="line">				 *                        Sr</span><br><span class="line">				 */</span><br><span class="line">				sibling-&gt;rb_left = tmp1 = tmp2-&gt;rb_right;</span><br><span class="line">				tmp2-&gt;rb_right = sibling;</span><br><span class="line">				parent-&gt;rb_right = tmp2;</span><br><span class="line">				if (tmp1)</span><br><span class="line">					rb_set_parent_color(tmp1, sibling,</span><br><span class="line">							    RB_BLACK);</span><br><span class="line">				augment_rotate(sibling, tmp2);</span><br><span class="line">				tmp1 = sibling;</span><br><span class="line">				sibling = tmp2;</span><br><span class="line">			&#125;</span><br><span class="line">			/*</span><br><span class="line">			 * Case 4 - left rotate at parent + color flips</span><br><span class="line">			 * (p and sl could be either color here.</span><br><span class="line">			 *  After rotation, p becomes black, s acquires</span><br><span class="line">			 *  p&apos;s color, and sl keeps its color)</span><br><span class="line">			 *</span><br><span class="line">			 *      (p)             (s)</span><br><span class="line">			 *      / \             / \</span><br><span class="line">			 *     N   S     --&gt;   P   Sr</span><br><span class="line">			 *        / \         / \</span><br><span class="line">			 *      (sl) sr      N  (sl)</span><br><span class="line">			 */</span><br><span class="line">			parent-&gt;rb_right = tmp2 = sibling-&gt;rb_left;</span><br><span class="line">			sibling-&gt;rb_left = parent;</span><br><span class="line">			rb_set_parent_color(tmp1, sibling, RB_BLACK);</span><br><span class="line">			if (tmp2)</span><br><span class="line">				rb_set_parent(tmp2, parent);</span><br><span class="line">			__rb_rotate_set_parents(parent, sibling, root,</span><br><span class="line">						RB_BLACK);</span><br><span class="line">			augment_rotate(parent, sibling);</span><br><span class="line">			break;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			sibling = parent-&gt;rb_left;</span><br><span class="line">			if (rb_is_red(sibling)) &#123;</span><br><span class="line">				/* Case 1 - right rotate at parent */</span><br><span class="line">				parent-&gt;rb_left = tmp1 = sibling-&gt;rb_right;</span><br><span class="line">				sibling-&gt;rb_right = parent;</span><br><span class="line">				rb_set_parent_color(tmp1, parent, RB_BLACK);</span><br><span class="line">				__rb_rotate_set_parents(parent, sibling, root,</span><br><span class="line">							RB_RED);</span><br><span class="line">				augment_rotate(parent, sibling);</span><br><span class="line">				sibling = tmp1;</span><br><span class="line">			&#125;</span><br><span class="line">			tmp1 = sibling-&gt;rb_left;</span><br><span class="line">			if (!tmp1 || rb_is_black(tmp1)) &#123;</span><br><span class="line">				tmp2 = sibling-&gt;rb_right;</span><br><span class="line">				if (!tmp2 || rb_is_black(tmp2)) &#123;</span><br><span class="line">					/* Case 2 - sibling color flip */</span><br><span class="line">					rb_set_parent_color(sibling, parent,</span><br><span class="line">							    RB_RED);</span><br><span class="line">					if (rb_is_red(parent))</span><br><span class="line">						rb_set_black(parent);</span><br><span class="line">					else &#123;</span><br><span class="line">						node = parent;</span><br><span class="line">						parent = rb_parent(node);</span><br><span class="line">						if (parent)</span><br><span class="line">							continue;</span><br><span class="line">					&#125;</span><br><span class="line">					break;</span><br><span class="line">				&#125;</span><br><span class="line">				/* Case 3 - right rotate at sibling */</span><br><span class="line">				sibling-&gt;rb_right = tmp1 = tmp2-&gt;rb_left;</span><br><span class="line">				tmp2-&gt;rb_left = sibling;</span><br><span class="line">				parent-&gt;rb_left = tmp2;</span><br><span class="line">				if (tmp1)</span><br><span class="line">					rb_set_parent_color(tmp1, sibling,</span><br><span class="line">							    RB_BLACK);</span><br><span class="line">				augment_rotate(sibling, tmp2);</span><br><span class="line">				tmp1 = sibling;</span><br><span class="line">				sibling = tmp2;</span><br><span class="line">			&#125;</span><br><span class="line">			/* Case 4 - left rotate at parent + color flips */</span><br><span class="line">			parent-&gt;rb_left = tmp2 = sibling-&gt;rb_right;</span><br><span class="line">			sibling-&gt;rb_right = parent;</span><br><span class="line">			rb_set_parent_color(tmp1, sibling, RB_BLACK);</span><br><span class="line">			if (tmp2)</span><br><span class="line">				rb_set_parent(tmp2, parent);</span><br><span class="line">			__rb_rotate_set_parents(parent, sibling, root,</span><br><span class="line">						RB_BLACK);</span><br><span class="line">			augment_rotate(parent, sibling);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* Non-inline version for rb_erase_augmented() use */</span><br><span class="line">void __rb_erase_color(struct rb_node *parent, struct rb_root *root,</span><br><span class="line">	void (*augment_rotate)(struct rb_node *old, struct rb_node *new))</span><br><span class="line">&#123;</span><br><span class="line">	____rb_erase_color(parent, root, augment_rotate);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(__rb_erase_color);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Non-augmented rbtree manipulation functions.</span><br><span class="line"> *</span><br><span class="line"> * We use dummy augmented callbacks here, and have the compiler optimize them</span><br><span class="line"> * out of the rb_insert_color() and rb_erase() function definitions.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">static inline void dummy_propagate(struct rb_node *node, struct rb_node *stop) &#123;&#125;</span><br><span class="line">static inline void dummy_copy(struct rb_node *old, struct rb_node *new) &#123;&#125;</span><br><span class="line">static inline void dummy_rotate(struct rb_node *old, struct rb_node *new) &#123;&#125;</span><br><span class="line"></span><br><span class="line">static const struct rb_augment_callbacks dummy_callbacks = &#123;</span><br><span class="line">	dummy_propagate, dummy_copy, dummy_rotate</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">void rb_insert_color(struct rb_node *node, struct rb_root *root)</span><br><span class="line">&#123;</span><br><span class="line">	__rb_insert(node, root, dummy_rotate);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_insert_color);</span><br><span class="line"></span><br><span class="line">void rb_erase(struct rb_node *node, struct rb_root *root)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *rebalance;</span><br><span class="line">	rebalance = __rb_erase_augmented(node, root, &amp;dummy_callbacks);</span><br><span class="line">	if (rebalance)</span><br><span class="line">		____rb_erase_color(rebalance, root, dummy_rotate);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_erase);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Augmented rbtree manipulation functions.</span><br><span class="line"> *</span><br><span class="line"> * This instantiates the same __always_inline functions as in the non-augmented</span><br><span class="line"> * case, but this time with user-defined callbacks.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">void __rb_insert_augmented(struct rb_node *node, struct rb_root *root,</span><br><span class="line">	void (*augment_rotate)(struct rb_node *old, struct rb_node *new))</span><br><span class="line">&#123;</span><br><span class="line">	__rb_insert(node, root, augment_rotate);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(__rb_insert_augmented);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * This function returns the first node (in sort order) of the tree.</span><br><span class="line"> */</span><br><span class="line">struct rb_node *rb_first(const struct rb_root *root)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node	*n;</span><br><span class="line"></span><br><span class="line">	n = root-&gt;rb_node;</span><br><span class="line">	if (!n)</span><br><span class="line">		return NULL;</span><br><span class="line">	while (n-&gt;rb_left)</span><br><span class="line">		n = n-&gt;rb_left;</span><br><span class="line">	return n;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_first);</span><br><span class="line"></span><br><span class="line">struct rb_node *rb_last(const struct rb_root *root)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node	*n;</span><br><span class="line"></span><br><span class="line">	n = root-&gt;rb_node;</span><br><span class="line">	if (!n)</span><br><span class="line">		return NULL;</span><br><span class="line">	while (n-&gt;rb_right)</span><br><span class="line">		n = n-&gt;rb_right;</span><br><span class="line">	return n;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_last);</span><br><span class="line"></span><br><span class="line">struct rb_node *rb_next(const struct rb_node *node)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *parent;</span><br><span class="line"></span><br><span class="line">	if (RB_EMPTY_NODE(node))</span><br><span class="line">		return NULL;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * If we have a right-hand child, go down and then left as far</span><br><span class="line">	 * as we can.</span><br><span class="line">	 */</span><br><span class="line">	if (node-&gt;rb_right) &#123;</span><br><span class="line">		node = node-&gt;rb_right; </span><br><span class="line">		while (node-&gt;rb_left)</span><br><span class="line">			node=node-&gt;rb_left;</span><br><span class="line">		return (struct rb_node *)node;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * No right-hand children. Everything down and left is smaller than us,</span><br><span class="line">	 * so any &apos;next&apos; node must be in the general direction of our parent.</span><br><span class="line">	 * Go up the tree; any time the ancestor is a right-hand child of its</span><br><span class="line">	 * parent, keep going up. First time it&apos;s a left-hand child of its</span><br><span class="line">	 * parent, said parent is our &apos;next&apos; node.</span><br><span class="line">	 */</span><br><span class="line">	while ((parent = rb_parent(node)) &amp;&amp; node == parent-&gt;rb_right)</span><br><span class="line">		node = parent;</span><br><span class="line"></span><br><span class="line">	return parent;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_next);</span><br><span class="line"></span><br><span class="line">struct rb_node *rb_prev(const struct rb_node *node)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *parent;</span><br><span class="line"></span><br><span class="line">	if (RB_EMPTY_NODE(node))</span><br><span class="line">		return NULL;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * If we have a left-hand child, go down and then right as far</span><br><span class="line">	 * as we can.</span><br><span class="line">	 */</span><br><span class="line">	if (node-&gt;rb_left) &#123;</span><br><span class="line">		node = node-&gt;rb_left; </span><br><span class="line">		while (node-&gt;rb_right)</span><br><span class="line">			node=node-&gt;rb_right;</span><br><span class="line">		return (struct rb_node *)node;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * No left-hand children. Go up till we find an ancestor which</span><br><span class="line">	 * is a right-hand child of its parent.</span><br><span class="line">	 */</span><br><span class="line">	while ((parent = rb_parent(node)) &amp;&amp; node == parent-&gt;rb_left)</span><br><span class="line">		node = parent;</span><br><span class="line"></span><br><span class="line">	return parent;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_prev);</span><br><span class="line"></span><br><span class="line">void rb_replace_node(struct rb_node *victim, struct rb_node *new,</span><br><span class="line">		     struct rb_root *root)</span><br><span class="line">&#123;</span><br><span class="line">	struct rb_node *parent = rb_parent(victim);</span><br><span class="line"></span><br><span class="line">	/* Set the surrounding nodes to point to the replacement */</span><br><span class="line">	__rb_change_child(victim, new, parent, root);</span><br><span class="line">	if (victim-&gt;rb_left)</span><br><span class="line">		rb_set_parent(victim-&gt;rb_left, new);</span><br><span class="line">	if (victim-&gt;rb_right)</span><br><span class="line">		rb_set_parent(victim-&gt;rb_right, new);</span><br><span class="line"></span><br><span class="line">	/* Copy the pointers/colour from the victim to the replacement */</span><br><span class="line">	*new = *victim;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(rb_replace_node);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/Are-cache-line-ping-pong-and-false-sharing-the-same.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Are-cache-line-ping-pong-and-false-sharing-the-same.html" itemprop="url">Are cache-line-ping-pong and false sharing the same?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-25T09:14:46+08:00">
                2018-02-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/Are-cache-line-ping-pong-and-false-sharing-the-same.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/Are-cache-line-ping-pong-and-false-sharing-the-same.html" class="cy_cmt_count" data-xid="Are-cache-line-ping-pong-and-false-sharing-the-same.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/Are-cache-line-ping-pong-and-false-sharing-the-same.html" class="leancloud_visitors" data-flag-title="Are cache-line-ping-pong and false sharing the same?">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  319
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  2分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          Are cache-line-ping-pong and false sharing the same
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/Are-cache-line-ping-pong-and-false-sharing-the-same.html">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/mpich3-2-1-release.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/mpich3-2-1-release.html" itemprop="url">mpich3.2.1-release</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-24T11:12:59+08:00">
                2018-02-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/高性能计算/" itemprop="url" rel="index">
                    <span itemprop="name">高性能计算</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/mpich3-2-1-release.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/mpich3-2-1-release.html" class="cy_cmt_count" data-xid="mpich3-2-1-release.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/mpich3-2-1-release.html" class="leancloud_visitors" data-flag-title="mpich3.2.1-release">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  4,953
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  31分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          mpich3.2.1-release
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/mpich3-2-1-release.html">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/清理Zabbix历史数据.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/清理Zabbix历史数据.html" itemprop="url">清理Zabbix历史数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-08T18:35:41+08:00">
                2018-02-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/集群管理/" itemprop="url" rel="index">
                    <span itemprop="name">集群管理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/清理Zabbix历史数据.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/清理Zabbix历史数据.html" class="cy_cmt_count" data-xid="清理Zabbix历史数据.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/清理Zabbix历史数据.html" class="leancloud_visitors" data-flag-title="清理Zabbix历史数据">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  37
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  1分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>统计Zabbix各表的大小<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name AS &quot;Tables&quot;,</span><br><span class="line">	round(((data_length + index_length) / 1024 / 1024), 2) &quot;Size in MB&quot; </span><br><span class="line">	FROM information_schema.TABLES</span><br><span class="line">	WHERE table_schema = &apos;zabbix&apos;</span><br><span class="line">	ORDER BY (data_length + index_length) DESC;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/Linux内核源文件网址.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux内核源文件网址.html" itemprop="url">Linux内核源文件网址</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-26T16:56:46+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux开发/" itemprop="url" rel="index">
                    <span itemprop="name">Linux开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/Linux内核源文件网址.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/Linux内核源文件网址.html" class="cy_cmt_count" data-xid="Linux内核源文件网址.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/Linux内核源文件网址.html" class="leancloud_visitors" data-flag-title="Linux内核源文件网址">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  4
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  1分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.kernel.org/pub/linux/kernel/" target="_blank" rel="external">click here to download</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/Linux网络设备驱动原理文章收藏.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux网络设备驱动原理文章收藏.html" itemprop="url">Linux网络设备驱动原理文章收藏</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T17:31:28+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/Linux网络设备驱动原理文章收藏.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/Linux网络设备驱动原理文章收藏.html" class="cy_cmt_count" data-xid="Linux网络设备驱动原理文章收藏.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/Linux网络设备驱动原理文章收藏.html" class="leancloud_visitors" data-flag-title="Linux网络设备驱动原理文章收藏">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  56
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  1分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><a href="http://blog.chinaunix.net/uid-20672257-id-3147768.html" target="_blank" rel="external">网络设备驱动基本原理和框架</a></li>
<li><a href="http://blog.csdn.net/xy010902100449/article/details/47157113" target="_blank" rel="external">net_device 等数据结构</a></li>
<li><a href="http://blog.chinaunix.net/uid-29547110-id-5038812.html" target="_blank" rel="external">Linux网桥实现分析</a></li>
<li><a href="http://bbs.chinaunix.net/thread-2005999-1-1.html" target="_blank" rel="external">Netfilter之连接跟踪实现机制初步分析</a></li>
<li><a href="http://blog.csdn.net/jasonchen_gbd/article/details/44874321" target="_blank" rel="external">Linux协议栈-netfilter(2)-conntrack</a></li>
<li><a href="https://www.linuxidc.com/search.aspx?Where=Nkey&amp;Keyword=Linux内核--网络内核实现分析" target="_blank" rel="external">Linux网络内核实现分析</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/Linux-Namespace文章.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux-Namespace文章.html" itemprop="url">Linux Namespace文章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-19T10:49:56+08:00">
                2017-12-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/Linux-Namespace文章.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/Linux-Namespace文章.html" class="cy_cmt_count" data-xid="Linux-Namespace文章.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/Linux-Namespace文章.html" class="leancloud_visitors" data-flag-title="Linux Namespace文章">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  15
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  1分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          Linux namespace
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/Linux-Namespace文章.html">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/HPC集群运维总结8-未尽事宜.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/HPC集群运维总结8-未尽事宜.html" itemprop="url">HPC集群运维总结8-未尽事宜</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-12T20:20:28+08:00">
                2017-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/集群管理/" itemprop="url" rel="index">
                    <span itemprop="name">集群管理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/HPC集群运维总结8-未尽事宜.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/HPC集群运维总结8-未尽事宜.html" class="cy_cmt_count" data-xid="HPC集群运维总结8-未尽事宜.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/HPC集群运维总结8-未尽事宜.html" class="leancloud_visitors" data-flag-title="HPC集群运维总结8-未尽事宜">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  2,101
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  7分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>[TOC]</p>
<h3 id="未尽事宜"><a href="#未尽事宜" class="headerlink" title="未尽事宜"></a>未尽事宜</h3><p>由于时间精力和能力有限，很多想做的事情还没有来得及做，或者没能做，在这里也列出来，希望今后有管理员可以将这些工作完成。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/HPC集群运维总结8-未尽事宜.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/HPC集群运维总结7-故障处理.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/HPC集群运维总结7-故障处理.html" itemprop="url">HPC集群运维总结7-故障处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-12T20:20:27+08:00">
                2017-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/集群管理/" itemprop="url" rel="index">
                    <span itemprop="name">集群管理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/HPC集群运维总结7-故障处理.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/HPC集群运维总结7-故障处理.html" class="cy_cmt_count" data-xid="HPC集群运维总结7-故障处理.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/HPC集群运维总结7-故障处理.html" class="leancloud_visitors" data-flag-title="HPC集群运维总结7-故障处理">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  3,725
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  13分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>[TOC]</p>
<h3 id="常见故障"><a href="#常见故障" class="headerlink" title="常见故障"></a>常见故障</h3><h4 id="用户无法登录到集群"><a href="#用户无法登录到集群" class="headerlink" title="用户无法登录到集群"></a>用户无法登录到集群</h4><p>有如下几种原因会导致用户无法登录到集群：</p>
<ul>
<li>用户使用的是校园无线网络，校园无线网络不允许登录到集群。</li>
<li>用户在校园网外部登录集群，集群IP地址未暴露给外网，校园网外部无法直接访问。</li>
<li>用户使用校园内部有线网络，无法登录到集群，需要在集群管理服务器添加IP地址许可。</li>
<li>用户不存在，则无法登录集群。</li>
<li>用户长期不登录或者已归还集群，账户密码被锁定，则无法登录集群。
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/HPC集群运维总结7-故障处理.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.zhangchi.xyz/HPC集群运维总结6-监控与开关机.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZHANGCHI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DIYER糍粑的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/HPC集群运维总结6-监控与开关机.html" itemprop="url">HPC集群运维总结6-监控与开关机</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-12T20:20:26+08:00">
                2017-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/集群管理/" itemprop="url" rel="index">
                    <span itemprop="name">集群管理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/HPC集群运维总结6-监控与开关机.html#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://blog.zhangchi.xyz/HPC集群运维总结6-监控与开关机.html" class="cy_cmt_count" data-xid="HPC集群运维总结6-监控与开关机.html" itemprop="commentsCount" ></span>
                </a>
              
            
          

          
          
             <span id="/HPC集群运维总结6-监控与开关机.html" class="leancloud_visitors" data-flag-title="HPC集群运维总结6-监控与开关机">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">浏览量 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数</span>
                
                <span title="字数">
                  3,939
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">耗时</span>
                
                <span title="耗时">
                  14分
                </span>
              
	      
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>[TOC]</p>
<h3 id="集群软件环境"><a href="#集群软件环境" class="headerlink" title="集群软件环境"></a>集群软件环境</h3><p>集群目前所有软件都配置在/public/software目录下面，目前配置的有Intel编译器、OpenMPI、Mathlab2009、Matlab2016、lammps、FDTD等，还有很多需要的软件可能还没有安装。</p>
<p>很多集群的用户都喜欢在自己的目录下面安装计算软件，这就导致了同一个非常占用空间的软件在集群上面有多个副本，<strong>导致集群存储空间被大大浪费掉了。</strong></p>
<p>因此最好是能够及时统计用户需要使用的软件的信息，并和软件用户一起将软件安装到/public/software目录下面，并告知其他用户直接使用该目录下面的软件即可。</p>
<p>集群还安装了Torque5作业调度管理系统，目前主节点为node307，后期考虑将B区的所有节点都安装作业调度管理系统，并采用调度系统提交作业。</p>
<p><strong>总而言之，集群软件尽量安装到/public/software目录下面，并编写一定的说明文档，告知用户使用方法，可以找一些已经有过安装和使用经验的用户进行交流，让他们提供这些资料。</strong><br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/HPC集群运维总结6-监控与开关机.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7xsnoh.com2.z0.glb.clouddn.com/avatar.png"
               alt="ZHANGCHI" />
          <p class="site-author-name" itemprop="name">ZHANGCHI</p>
           
              <p class="site-description motion-element" itemprop="description">DIYER糍粑,CIBA,糍粑学习的地方</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">116</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">118</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhangciba" target="_blank" title="GitHub" rel="external nofollow">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/zhangchixtacbn" target="_blank" title="Weibo" rel="external nofollow">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhangchixtacbn" target="_blank" title="知乎" rel="external nofollow">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://adherence.cn" title="小燕子之家" target="_blank" rel="external nofollow">小燕子之家</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/zhangchi" title="博客园" target="_blank" rel="external nofollow">博客园</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/zhangchixtacbn" title="CSDN" target="_blank" rel="external nofollow">CSDN</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zhangchixtacbn.blog.163.com" title="网易博客" target="_blank" rel="external nofollow">网易博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://davi.space" title="Davi-Space" target="_blank" rel="external nofollow">Davi-Space</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.jayxhj.com" title="豪杰写字的地方" target="_blank" rel="external nofollow">豪杰写字的地方</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/ryanlamp/" title="大兵奋斗的地方" target="_blank" rel="external nofollow">大兵奋斗的地方</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.hust.edu.cn" title="华中科技大学" target="_blank" rel="external nofollow">华中科技大学</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZHANGCHI</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  










  




  
    <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cyt1YeKGz"></script>
  



  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("Q2wCx7ylg0R2b3SjDM49UpFA-gzGzoHsz", "tMTqAIprel7Bdpgm463fDDsY");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

</body>
</html>
